@use "../../styles/abstracts" as *;

/* ============================================================
   ACCESSIBILITY BAR
   Israeli-style fixed side strip with slide-out panel
   ============================================================ */

/* ── Z-index above everything except modals ── */
$a11y-z: 950;

/* ─────────────────────────────────────────────
   TRIGGER BUTTON — fixed left strip
   ───────────────────────────────────────────── */
.a11y-trigger {
    position: fixed;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    z-index: $a11y-z + 1;

    display: flex;
    align-items: center;
    gap: 4px;
    writing-mode: vertical-rl;
    text-orientation: mixed;

    padding: 14px 8px;
    border: none;
    border-radius: 0 $radius-lg $radius-lg 0;
    background: $color-primary;
    color: #fff;
    font-family: $font-primary;
    font-size: 0.8rem;
    font-weight: $font-weight-bold;
    letter-spacing: 0.03em;
    cursor: pointer;

    box-shadow: 2px 2px 12px rgba(0, 0, 0, 0.15);
    transition:
        background $transition-base,
        transform $transition-base,
        box-shadow $transition-base;

    &:hover {
        background: $color-darkest;
        box-shadow: 2px 4px 20px rgba(0, 0, 0, 0.25);
    }

    &:focus-visible {
        outline: 3px solid $color-accent;
        outline-offset: 2px;
    }

    &--open {
        transform: translateY(-50%) translateX(-2px);
        background: $color-darkest;
    }

    &__icon {
        font-size: 1.4rem;
        flex-shrink: 0;
    }

    &__label {
        margin-top: 4px;
    }

    /* Mobile: smaller, icon only */
    @media (max-width: $breakpoint-sm) {
        padding: 10px 6px;

        &__label {
            display: none;
        }

        &__icon {
            font-size: 1.3rem;
        }
    }
}

/* ─────────────────────────────────────────────
   PANEL — slides out from the left
   ───────────────────────────────────────────── */
.a11y-panel {
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    z-index: $a11y-z;

    width: 320px;
    max-width: 90vw;
    background: #fff;
    box-shadow: 6px 0 30px rgba(0, 0, 0, 0.12);
    border-right: 1px solid $border-light;

    display: flex;
    flex-direction: column;

    transform: translateX(-100%);
    visibility: hidden;
    transition:
        transform 0.35s cubic-bezier(0.4, 0, 0.2, 1),
        visibility 0.35s;

    &--open {
        transform: translateX(0);
        visibility: visible;
    }

    /* ── Header ── */
    &__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px 20px 16px;
        border-bottom: 1px solid $border-light;
        background: linear-gradient(135deg, $color-primary 0%, $color-darkest 100%);
        color: #fff;
    }

    &__header-text {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    &__header-icon {
        font-size: 1.6rem;
        opacity: 0.9;
    }

    &__title {
        font-family: $font-heading;
        font-size: 1.2rem;
        font-weight: $font-weight-bold;
        margin: 0;
    }

    &__close {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 34px;
        height: 34px;
        border: none;
        border-radius: $radius-md;
        background: rgba(255, 255, 255, 0.12);
        color: #fff;
        font-size: 1.1rem;
        cursor: pointer;
        transition: background $transition-fast;

        &:hover {
            background: rgba(255, 255, 255, 0.22);
        }

        &:focus-visible {
            outline: 2px solid #fff;
            outline-offset: 2px;
        }
    }

    /* ── Body ── */
    &__body {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
    }

    &__divider {
        height: 1px;
        background: $border-light;
        margin: 16px 0;
    }

    /* ── Footer ── */
    &__footer {
        padding: 14px 20px;
        border-top: 1px solid $border-light;
        background: #fafafa;
    }
}

/* ─────────────────────────────────────────────
   FONT SIZE SECTION
   ───────────────────────────────────────────── */
.a11y-section {
    &__label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-family: $font-primary;
        font-size: 0.9rem;
        font-weight: $font-weight-semibold;
        color: $text-primary;
        margin-bottom: 12px;
    }

    &__icon {
        font-size: 1.1rem;
        color: $color-primary;
    }
}

.a11y-font-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    background: $color-background;
    border-radius: $radius-lg;
    padding: 8px 12px;
}

.a11y-font-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    min-width: 44px;
    height: 40px;
    padding: 0 10px;
    border: 1px solid $border-light;
    border-radius: $radius-md;
    background: #fff;
    color: $text-primary;
    font-family: $font-primary;
    font-size: 0.85rem;
    font-weight: $font-weight-semibold;
    cursor: pointer;
    transition: all $transition-fast;

    svg {
        font-size: 0.75rem;
    }

    &:hover:not(:disabled) {
        background: $color-primary;
        color: #fff;
        border-color: $color-primary;
    }

    &:disabled {
        opacity: 0.35;
        cursor: not-allowed;
    }

    &:focus-visible {
        outline: 2px solid $color-primary;
        outline-offset: 2px;
    }

    /* Larger "א" for the increase button */
    &--large span {
        font-size: 1.05rem;
    }
}

.a11y-font-value {
    min-width: 52px;
    text-align: center;
    font-family: $font-primary;
    font-size: 0.825rem;
    font-weight: $font-weight-medium;
    color: $text-muted;
}

/* ─────────────────────────────────────────────
   TOGGLE BUTTONS
   ───────────────────────────────────────────── */
.a11y-toggles {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.a11y-toggle {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px 10px;
    border: 1.5px solid $border-light;
    border-radius: $radius-lg;
    background: #fff;
    cursor: pointer;
    transition: all $transition-base;
    font-family: $font-primary;

    &:hover {
        border-color: $color-medium;
        background: rgba($color-medium, 0.04);
    }

    &:focus-visible {
        outline: 2px solid $color-primary;
        outline-offset: 2px;
    }

    /* Active state */
    &--active {
        border-color: $color-primary;
        background: rgba($color-primary, 0.06);
        box-shadow: 0 2px 8px rgba($color-primary, 0.12);

        .a11y-toggle__icon-wrap {
            background: $color-primary;
            color: #fff;
            box-shadow: 0 3px 10px rgba($color-primary, 0.25);
        }

        .a11y-toggle__text {
            color: $color-primary;
            font-weight: $font-weight-semibold;
        }
    }

    &__icon-wrap {
        width: 42px;
        height: 42px;
        border-radius: $radius-md;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        background: $color-background;
        color: $text-muted;
        transition: all $transition-base;
    }

    &__text {
        font-size: 0.8rem;
        font-weight: $font-weight-medium;
        color: $text-primary;
        text-align: center;
        line-height: 1.3;
        transition: color $transition-fast;
    }
}

/* ─────────────────────────────────────────────
   RESET BUTTON
   ───────────────────────────────────────────── */
.a11y-reset {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 10px;
    border: 1.5px solid $border-light;
    border-radius: $radius-md;
    background: #fff;
    color: $text-primary;
    font-family: $font-primary;
    font-size: 0.85rem;
    font-weight: $font-weight-medium;
    cursor: pointer;
    transition: all $transition-fast;

    svg {
        font-size: 0.95rem;
    }

    &:hover {
        background: #fee2e2;
        border-color: #fca5a5;
        color: #dc2626;
    }

    &:focus-visible {
        outline: 2px solid $color-primary;
        outline-offset: 2px;
    }
}

/* ─────────────────────────────────────────────
   READING GUIDE RULER
   ───────────────────────────────────────────── */
.a11y-reading-ruler {
    position: fixed;
    left: 0;
    right: 0;
    height: 38px;
    z-index: $a11y-z - 1;
    pointer-events: none;
    border-top: 2px solid rgba($color-accent, 0.6);
    border-bottom: 2px solid rgba($color-accent, 0.6);
    background: rgba($color-accent, 0.06);
    transform: translateY(-50%);
    transition: top 0.05s linear;
}

/* ============================================================
   GLOBAL ACCESSIBILITY OVERRIDES
   Applied via classes on <html>
   ============================================================ */

/* ── Font scaling ── */
html.a11y-font-scaled {
    body {
        font-size: calc(1rem + var(--a11y-font-delta, 0px)) !important;
    }

    // Scale up common text elements proportionally
    p,
    li,
    td,
    th,
    span,
    label,
    input,
    textarea,
    select,
    button {
        font-size: inherit;
    }
}

/* ── High contrast ── */
html.a11y-high-contrast {
    body {
        background: #000 !important;
        color: #fff !important;
    }

    * {
        border-color: #fff !important;
    }

    a {
        color: #ffff00 !important;
    }

    // Cards, sections, etc.
    .hs-card__title,
    .hero__title,
    .hero__title-highlight,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        color: #fff !important;
    }

    .a11y-panel {
        background: #111 !important;

        &__body {
            color: #fff;
        }
    }

    .a11y-toggle {
        background: #222 !important;
        border-color: #555 !important;
        color: #fff !important;

        &--active {
            border-color: #ffff00 !important;
            background: #333 !important;
        }

        &__text {
            color: #fff !important;
        }

        &__icon-wrap {
            background: #333 !important;
            color: #fff !important;
        }
    }

    .a11y-font-btn {
        background: #222 !important;
        color: #fff !important;
        border-color: #555 !important;

        &:hover:not(:disabled) {
            background: #ffff00 !important;
            color: #000 !important;
        }
    }

    .a11y-font-value {
        color: #ccc !important;
    }

    .a11y-reset {
        background: #222 !important;
        color: #fff !important;
        border-color: #555 !important;
    }

    .a11y-font-controls {
        background: #1a1a1a !important;
    }

    .a11y-panel__footer {
        background: #111 !important;
    }

    img {
        filter: brightness(0.85) contrast(1.2);
    }
}

/* ── Grayscale ── */
html.a11y-grayscale {
    body {
        filter: grayscale(100%);
    }

    // Keep the a11y panel itself in color
    .a11y-panel,
    .a11y-trigger {
        filter: grayscale(0%);
    }
}

/* ── Link highlighting ── */
html.a11y-link-highlight {
    a:not(.a11y-trigger):not(.a11y-panel a) {
        outline: 2px solid $color-accent !important;
        outline-offset: 2px;
        text-decoration: underline !important;
        text-decoration-color: $color-accent !important;
        text-underline-offset: 3px;
        border-radius: 2px;
    }

    button:not(.a11y-trigger):not(.a11y-panel button) {
        outline: 2px dashed $color-medium !important;
        outline-offset: 2px;
    }
}
